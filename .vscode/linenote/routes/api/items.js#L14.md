auth added into file after making middleware

protects the routes